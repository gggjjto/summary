# 题目

### 学生成绩管理

实验要求：

- 添加学生功能：姓名、学号、性别、出生年月日。（学号自动生成且唯一）

- 添加学生成绩功能：每个人都有数学、Java、英语、体育四门课，可分课程输入成绩。

- 根据学生学号查找学生成绩功能：在界面上显示姓名、学号和成绩，学号不存在的能给出提示信息。

- 根据学生姓名（支持模糊匹配）查找学生成绩功能：并在界面上显示姓名、学号和成绩，如果有多个相同姓名学生存在，一起显示出来，姓名不存在的给出提示信息。

- 支持对单个学生各科成绩画出柱状分布图。

- 学生信息的修改与删除功能：不能修改学号。

- 生成学生学习情况报表功能：报表包含学号、姓名、各科目成绩及对应的该科目班级平均值，总成绩以及班级总成绩平均值，并将该排序结果输出至excel文件。

# 需求分析

对于广大的学生群体，在管理成绩使用一套成熟的管理系统是必须的

对于每个学生要储存他的姓名、学号、性别、出生年月日，以及他的一些成绩，满足在查询的过程中导出成绩的表，有可视化界面使得方便操作，对于成绩要有直观的图形表示他的成绩，支持在忘记名字以后的模糊查询方便查询

# 总体设计

使用的总体技术有：vue，spring，mybatis，axios，mysql

使用vue对前端界面进行编写，使用spring对后端逻辑进行编写，使用mybatis在后端进行mysql语句的查询，删除，修改，插入，使用mysql对数据进行储存，后端和前端使用axios使用get和post请求进行交互。

# 详细实现

使用mysql进行数据的储存使用sql语句进行建表等操作，对于数据的依赖关系需要在后端和前端进行实现：

```sql
//学生表
CREATE TABLE student(
    sid int(11),
    sname varchar(50) ,
    sgender varchar(50),
    sbirthday date,
    sclass_id int(11)
);
//成绩表
CREATE TABLE scores(
    cid int(11),
    student_id int(11) ,
    javascore float ,
    englishscore float,
    mathscore float,
    sportsscore float
);
//用户表
CREATE TABLE passworld(
    id int(11) ,
    username varchar(50) ,
    password varchar(50)
);
```

完成后可以插入一些预留数据测试后端程序

```sql
INSERT INTO `student` (`sid`, `sname`, `sgender`, `sbirthday`, `sclass_id`) VALUES
(1, '张三', '男', '2000-01-01', 1),
(2, '李四', '男', '2000-02-02', 1),
(3, '王五', '女', '2000-03-03', 2),
(4, '赵六', '女', '2000-04-04', 2),
(5, '钱七', '男', '2000-05-05', 3),
(6, '孙八', '男', '2000-06-06', 3),
(7, '周九', '女', '2000-07-07', 4),
(8, '吴十', '女', '2000-08-08', 4),
(9, '郑一', '男', '2000-09-09', 5),
(10, '唐二', '男', '2000-10-10', 5);

INSERT INTO scores(student_id, javascore, englishscore, mathscore, sportsscore) VALUES
(1, 89.5, 77, 92.0, 85.5),
(2, 78, 85, 80.5, 91),
(3, 92.5, 90, 93.5, 95),
(4, 83, 88, 77, 81),
(5, 94, 91.5, 87, 92),
(6, 82.5, 78, 84.5, 76.5),
(7, 90, 85, 88, 86),
(8, 93.5, 92, 96, 91),
(9, 81.5, 87, 80, 79),
(10, 88, 85.5, 86.5, 84);

INSERT INTO `passworld` (`id`, `username`, `password`) VALUES
(1, 'user1', 'password1'),
(2, 'user2', 'password2'),
(3, 'user3', 'password3'),
(4, 'user4', 'password4'),
(5, 'user5', 'password5');
```

在后端编写程序时需要对mysql的数据进行操作故使用mybatis对数据进行操作，利用Mapper.xml对mysql进行操作：

```xml
<!--插入-->
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.mapper.StudentMapper">

    <insert id="registerstudent" parameterType="org.example.boot.bean.Student">
        insert into student(sid,sname, sgender, sbirthday, sclass_id) values (#{student.sid},#{student.sname},#{student.sgender},#{student.sbirthday},#{student.sclass_id})
    </insert>
</mapper>

<!--查询-->
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.mapper.SelectMapper">

    <select id="reqisterselect" resultType="org.example.boot.bean.Select" parameterType="integer">
        SELECT s.sid, s.sname,s.sbirthday,s.sgender,s.sclass_id,c.englishscore,c.javascore,c.mathscore,c.sportsscore FROM student s,scores c WHERE s.sid=c.student_id AND s.sid=#{sid};
    </select>
    <select id="reqisterSelectAll" resultType="org.example.boot.bean.Select">
        SELECT s.sid, s.sname,s.sbirthday,s.sgender,s.sclass_id,c.englishscore,c.javascore,c.mathscore,c.sportsscore FROM student s,scores c WHERE s.sid=c.student_id
    </select>
</mapper>


<!--删除-->
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.mapper.DeleteDataMapper">

    <delete id="reqisterDelete" parameterType="org.example.boot.bean.Select">
        DELETE FROM student WHERE sid=#{sid};
    </delete>

    <delete id="reqisterDelete1" parameterType="org.example.boot.bean.Select">
        DELETE FROM scores WHERE student_id=#{sid};
    </delete>

</mapper>

<!--修改-->
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.example.mapper.AmendMapper">

    <update id="reqisterAmend" parameterType="org.example.boot.bean.Select">
        UPDATE student SET sname=#{select.sname},sclass_id=#{select.sclass_id},sbirthday=#{select.sbirthday},sgender=#{select.sgender} WHERE sid=#{select.sid};
    </update>

    <update id="reqisterAmend1" parameterType="org.example.boot.bean.Select">
        UPDATE scores SET javascore=#{select.javascore},mathscore=#{select.mathscore},englishscore=#{select.englishscore},sportsscore=#{select.sportsscore} WHERE student_id=#{select.sid};
    </update>

</mapper>
```

在使用xml后，用spring编写接口，通过使用@param绑定传入xml文件的数据：

```java
package org.example.mapper;

import org.apache.ibatis.annotations.Param;
import org.example.boot.bean.Select;

public interface AmendMapper {
    void reqisterAmend(@Param("select")Select select);
    void reqisterAmend1(@Param("select") Select select);
}

```

在使用以上代码时需要编写一个类来，完成数据的传递,在其中使用lombok减少代码量	：

```java
package org.example.boot.bean;

import lombok.Data;
import lombok.Getter;
import lombok.Value;
/**
 * @author jp
 * @dateTime: 2023-6-1
 * @description: 登录service
 * */
@Data
@Getter
@Value
public class Select {
    private Integer sid;
    private String sname;
    private String sbirthday;
    private String sgender;
    private Integer sclass_id;
    private Integer javascore;
    private Integer mathscore;
    private Integer englishscore;
    private Integer sportsscore;
}

```

再编写Service类，完成主体逻辑的编写，封装成一个类以便后面的操作：

```java
package org.example.boot.Service;


import org.example.mapper.LoginMapper;
import org.springframework.stereotype.Service;

import javax.annotation.Resource;

/**
 * @author jp
 * @dateTime: 2023-6-1
 * @description: 登录service
 * */
@Service
public class LoginService {
    @Resource
    private LoginMapper loginMapper;
    // 登录
    public String loginTosystem(String username,String password){
        String message = "";
        // 判断登录的角色是否为空
        if(loginMapper.loginTosystem(username,password)== null) {
            message = "登录失败";
        }else {
            loginMapper.loginTosystem(username,password);
            message = "登录成功";
        }
        return message;
    }
    public boolean loginTosystem1(String username,String password){
        boolean message;
        // 判断登录的角色是否为空
        if(loginMapper.loginTosystem(username,password)== null) {
            message = false;
        }else {
            loginMapper.loginTosystem(username,password);
            message = true;
        }
        return message;
    }

    // 获取登录人员的姓名
    public String findName(Integer id) {
        return loginMapper.findName(id);
    }
}

```

再编写Controller类对之前的方法进行调用，使用@RequestMapping实现数据的接收：

```java
package org.example.controller;


import org.example.boot.Service.LoginService;
import org.example.boot.Vo.ResultVo;
import org.example.boot.constant.ResutEnum;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import javax.annotation.Resource;

@RestController
//@RequestMapping("/login/**")
public class LoginController {
    @Resource
    private LoginService loginService;

    // 登录到系统
    @RequestMapping("/loginTosystem")
    public ResultVo loginTosystem(@RequestParam("username")String username, @RequestParam("password")String password) {
        if(loginService.loginTosystem1(username,password)){
            return new ResultVo(ResutEnum.OK,loginService.loginTosystem(username,password));
        }
        else{
            return new ResultVo(ResutEnum.Error,loginService.loginTosystem(username,password));
        }

    }
    @RequestMapping("/findName")
    public ResultVo findName(@RequestParam("id")Integer id) {
        return new ResultVo(ResutEnum.OK,loginService.findName(id));
    }

    @RequestMapping("/hello1")
    public String handle01(){
        return "Hello,Spring boot 2";
    }
}


```

对用数据的发送还需要一个ResultVo类，用于状态，数据的发送：

```java
package org.example.boot.Vo;

import lombok.Getter;
import org.example.boot.constant.ResutEnum;

@Getter
public class ResultVo<T> {
    private T data;
    private Integer code;
    private String message;
    public ResultVo(ResutEnum resutEnum) {
        this.code = resutEnum.getCode();
        this.message = resutEnum.getMessage();
        data = null;
    }
    public ResultVo(ResutEnum resutEnum,T data) {
        this.code = resutEnum.getCode();
        this.message = resutEnum.getMessage();
        this.data = data;
    }
    public ResultVo(Integer code,String message,T data){
        this.code = code;
        this.message = message;
        this.data = data;
    }
}


```

还需要对域名继续拦截和放行：

```java
package org.example.boot.config;

import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class CorsConfig implements WebMvcConfigurer{
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        //设置允许跨域
        registry.addMapping("/**")
                .allowedOrigins("*")
                // 设置允许跨域请求的域名
                //.allowedOriginPatterns("*")
                //设置允许的方法
                .allowedMethods("*")
                .maxAge(3600);
    }
}

```

在对后端的代码进行完编写后开始前端代码，前端使用Vue和一些衍生环境对前端界面进行编写

在main.js文件中引入必要的模块和插件：

```js
import { createApp } from 'vue'
import App from './App.vue'
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'
import router from "@/router";
import axios from "axios";

const app=createApp(App)
app.use(ElementPlus)
app.use(router)
app.config.globalProperties.$axios=axios;
app.mount('#app')
```

对Vue进行一些初始化的设置在vue.config.js文件中

```js
const { defineConfig } = require('@vue/cli-service')

module.exports = defineConfig({
  publicPath: '/',
  lintOnSave: false,
  //transpileDependencies: true,
  devServer: {
    allowedHosts: ['localhost'], // 替换掉 disableHostCheck
    open: true,
    port: 8080,
    proxy: {
      '@(/)': {
        // 连接到后端的路径
        target: 'http://localhost:8081/student',
        changeOrigin: true,
        secure: false,
        pathRewrite: {
          '^/': '/'
        }
      }
    }
  }
})
```

设置响应拦截器和请求拦截器

```js
import axios from 'axios'

// 创建axios实例
// eslint-disable-next-line no-unused-vars
const service = axios.create({
    //baseURL: '/', // api的base_Url
    // 后端的请求路径
    baseURL: 'http://localhost:8081/student', // api的base_Url
    timeout: 50000 // 请求超时时间
})

// 请求拦截器
axios.interceptors.request.use(
    function (config) {
        // 在发送请求之前做些什么
        return config
    },
    function (error) {
        // 对请求错误做些什么
        return Promise.reject(error)
    }
)

// 响应拦截器
axios.interceptors.response.use(
    function (config) {
        // 对响应数据做点什么
        return config
    },
    function (error) {
        // 对响应错误做点什么
        return Promise.reject(error)
    }
)

export default service


```

然后编写get和post的方法

```js
//post.js
// 导入axios配置
import service from '../utils/request'

// 注册账号
export function registerAccount (obj) {
    return service.post('/registerAccount', JSON.stringify(obj), {
        headers: { 'Content-Type': 'application/json' }
    })
}

export function registerStudent(obj){
    return service.post('/student_1',JSON.stringify(obj),{
        headers:{'Content-Type':'application/json'}
    })
}

export function registerScore(obj){
    return service.post('/score',JSON.stringify(obj),{
        headers:{'Content-Type':'application/json'}
    })
}
```

```js
//get.js
// 导入axios配置
import service from '../utils/request'

// 登录
export function loginTosystem(username, password) {
    return service.get('/loginTosystem', {
        headers: { 'Content-Type': 'application/json' },
        params: {
            username: username,
            password: password
        }
    })
}

export function SelectTosystem(sid){
    return service.get('/select',{
        headers:{'Content-Type':'application/json'},
        params:{
            sid:sid
        }
    })
}

export function NameSelectTosystem(sname){
    return service.get('/NameSelect',{
        headers:{'Content-Type':'application/json'},
        params:{
            sname:sname
        }
    })
}

export function registerDataOperation(formData){
    return service.get('/Amend',{
        headers:{'Content-Type':'application/json'},
        params:formData
    })
}

export function dataSelectTosystem(){
    return service.get('allSelect',{
        headers:{'Content-Type':'application/json'}
    })
}

export function DeleteData(sid){
    return service.get('/DeleteData',{
        headers:{'Content-Type':'application/json'},
        params:{
            sid:sid
        }
    })
}



```

再编写Vue组件和网页路由：
配置好路由以后使用router-view显示页面
```vue
<!--App.vue-->

<template>
  <div>
      <router-view></router-view>
  </div>
</template>

<script>
export default {
  name: 'App',
  components: {
  }
}
</script>


```

在其他vue组件编写好以后，插入到主页面和登入页面中
```vue
<!--主页面-->
<template>
    <el-tabs :tab-position="tabPosition" style="height: 200px" class="demo-tabs">
      <el-tab-pane label="添加学生">
        <Addstudent_1></Addstudent_1>
      </el-tab-pane>
      <el-tab-pane label="学号查找">
        <StudentNumberSearch/>
      </el-tab-pane>
      <el-tab-pane label="姓名查找">
        <NameSelect/>
      </el-tab-pane>
      <el-tab-pane label="信息修改">
        <DataOperation/>
      </el-tab-pane>
      <el-tab-pane label="信息删除">
        <delete-data/>
      </el-tab-pane>
      <el-tab-pane label="学习情况报表">
        <StudyExcel/>
      </el-tab-pane>
    </el-tabs>

</template>

<script>
import Addstudent_1 from "@/components/addstudent";
import StudentNumberSearch from "@/components/StudentNumberSearch";
import NameSelect from "@/components/NameSelect";
import DataOperation from "@/components/DataOperation";
import DeleteData from "@/components/DeleteData";
import StudyExcel from "@/components/StudyExcel";
export default{
  name:'navigation_1',
  components: {
    Addstudent_1,
    StudentNumberSearch,
    NameSelect,
    DataOperation,
    DeleteData,
    StudyExcel
  },
  data(){
    return{
    }
  }
}
</script>

<style scoped>
.demo-tabs > .el-tabs__content {
  padding: 32px;
  color: #6b778c;
  font-size: 32px;
  font-weight: 600;
}

.el-tabs--right .el-tabs__content,
.el-tabs--left .el-tabs__content {
  height: 100%;
}
</style>
```

```vue
<!--登入页面-->
<template>
  <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<!-- 背景图片插入 -->
  <div class="tupiandiv">
    <div class="boxmodel">
    </div>
  </div>

<!-- 登入模块插入 -->
  <div class="box">
    <UserLogin/>
  </div>

</template>

<script>
import UserLogin from './Login'
export default {
  name: "LoginTupian",
  components: {
    UserLogin
  }
}
</script>

<style scoped>

.boxmodel{
  width: 100%;
  height: 100%;
  padding: 0;
  border: 0;
  margin: 0;
  background: url("../assets/Loign.jpg") no-repeat;
  background-size: cover;
  background-position: center;
  border-radius: 10px;
  display: block;

}
.tupiandiv{
  height: 100vh; /* 设置高度为视口高度 */
  width: 100vw; /* 设置宽度为视口宽度 */
  position: absolute; /* 绝对定位 */
  top: 0; /* 上边距为 0 */
  left: 0; /* 左边距为 0 */
}
.box{
  margin-top: 28%;
  margin-left: 60%;
}
</style>
```

在index.js文件中配置路由，用于对网页的跳转

```js
// router.js 文件
import { createRouter, createWebHistory } from 'vue-router'
import LoginTupian from "@/components/LoginTupian";
import Boos_1 from '../components/Boos'

const routes = [
    {
        path: '/',
        redirect: '/login'
    },
    {
        path: '/login',
        name: 'login',
        component: LoginTupian
    },
    {
        path: '/boos',
        name: 'boos',
        component: Boos_1,
        //meta: { requiresAuth: true } // 添加元数据，表示需要登录验证
    }
]

const router = createRouter({
    history: createWebHistory(),
    routes
})

export default router
```

在组件文件中的要完成数据的发送和接收，一段删除数据的操作，调用get.js和post.js中的方法完成：

```vue
<template>
  <div>
    <el-button @click="onSubmit">查询</el-button>
    <el-table :data="students" height="500" style="width: 100%">
      <el-table-column prop="sid" label="学号" width="100"></el-table-column>
      <el-table-column prop="sname" label="姓名" width="150"></el-table-column>
      <el-table-column prop="sclass_id" label="班级" width="150"></el-table-column>
      <el-table-column prop="sbirthday" label="生日" width="150"></el-table-column>
      <el-table-column prop="sgender" label="性别" width="100"></el-table-column>
      <el-table-column prop="javascore" label="Java 成绩" width="120"></el-table-column>
      <el-table-column prop="mathscore" label="数学成绩" width="120"></el-table-column>
      <el-table-column prop="englishscore" label="英语成绩" width="120"></el-table-column>
      <el-table-column prop="sportsscore" label="体育成绩" width="120"></el-table-column>
      <el-table-column label="操作" width="120">
        <template v-slot="scope">
          <el-button type="success" @click="handleDelete(scope.row)">删除</el-button>
        </template>
      </el-table-column>
    </el-table>
  </div>
</template>

<script>
import {dataSelectTosystem} from "@/api/get";
import {DeleteData} from "@/api/get";
export default {
  name:"DeleteData",
  data() {
    return {
      students: [],
    }
  },
  methods: {
    onSubmit(){
      console.log("查询")
      dataSelectTosystem().then(res=>{
        this.students=res.data.data;
        console.log(this.students)
      })
    },
    handleDelete(row) {
      const sid = row.sid; // 获取当前行对象的学号
      // 在这里进行你的操作，比如弹出学号或调用某个方法
      DeleteData(sid).then(res=>{
        this.onSubmit()
        console.log(res.data.code)
      })
      console.log(sid);
    }

  }
}
</script>
```

# 结果与分析

实验结果：

![image-20230601224734032](./%E5%AD%A6%E4%B9%A0%E6%96%87%E4%BB%B6/imgs/image-20230601224734032.png)

![image-20230601224754553](./%E5%AD%A6%E4%B9%A0%E6%96%87%E4%BB%B6/imgs/image-20230601224754553.png)

![image-20230601225018592](./%E5%AD%A6%E4%B9%A0%E6%96%87%E4%BB%B6/imgs/image-20230601225018592.png)

![image-20230601225038568](./%E5%AD%A6%E4%B9%A0%E6%96%87%E4%BB%B6/imgs/image-20230601225038568.png)

![image-20230601225047849](./%E5%AD%A6%E4%B9%A0%E6%96%87%E4%BB%B6/imgs/image-20230601225047849.png)

![image-20230601225059711](./%E5%AD%A6%E4%B9%A0%E6%96%87%E4%BB%B6/imgs/image-20230601225059711.png)

![image-20230601225110697](./%E5%AD%A6%E4%B9%A0%E6%96%87%E4%BB%B6/imgs/image-20230601225110697.png)

分析：使用spring和Vue的框架可以快速的便写前端和后端代码，有一些实际开发项目的技术没有实现，例如：网页护航，信息安全等。

# 小结与心得

在这一次的课设中，因为之前的懈怠对于框架的使用并不熟悉，学一部分Vue后，在课设的过程中想用Vue+spring boot来完成本次课设，在编写完前端页面以后，加班加点的学习了SSM，再学习了springboot的基本使用，但是因为时间短对于spring的特性只了解了一部分，在编写代码的过程中报了很多错误，有逻辑性的，有原理性的，刚刚接触到的错误花了不少时间去解决，慢慢的也轻车熟路了，这次课设学到的东西也挺多的，在这样的时候就应该逼自己。

不足：在本次的课设中，在业务逻辑上写的并不好，在需求分析上只是实现一部分简单的功能，希望在今后的学习当中逐步学习这部分的知识。

如果遇到8081占用`netstat -ano`查看进程，`taskkill /F /PID 进程ID`终止进程ID



